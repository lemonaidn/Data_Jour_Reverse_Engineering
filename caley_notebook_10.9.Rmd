---
title: "CFS_reverse_engineering_project"
output: html_document
date: "2023-10-23"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##Load the data from 538.

Convert the Amount column from a character to a dbl, removing the dollar sign and the comma from each Amount entry. We used mutate(parse_number()) to do so. 

```{r}
library(tidyverse)
library(readr)
library(scales)

donation_df = read_csv("sports-political-donations.csv")

donation_df <- donation_df |> 
  mutate(Amount = parse_number(Amount))

donation_df

```
##Finding 1: 

“A deep search in the Federal Election Commission database of campaign finances for principal owners, controlling owners, co-owners and commissioners from the NBA, NFL, NHL, WNBA, MLB and NASCAR reveals that this deep-pocketed group has sent $34.2 million (72.9 percent) to Republican campaigns or super PACs purely supporting Republican causes, compared to $10.1 million (21.5 percent) to Democrats over the past three elections.”

To determine the total amount of donations by political party, we decided to group_by Party and use summarise() to create a party_total column that sums the amount donated per party. We then arranged in descending order to get the totals from highest to lowest. We successfully reproduced this first finding from 538's article. 

```{r}

donations_by_party <- donation_df |>
  group_by(Party) |>
  summarise(party_total = sum(Amount)) |>
  arrange(desc(party_total))

donations_by_party

```

##Finding 2

“Overall, 51.7 percent of all contributions by WNBA owners went to Democrats, with 42.3 percent going to Republicans.”

To reproduce this finding, we initially tried filtering by League = "WNBA," but we were getting incorrect results (Republican was way too high). We realized that this method was missing some rows because certain owners own teams in multiple leagues, and those entries not showing up here. To fix this, we used str_detect to find all correct instances of WNBA in League, even if it was paired with other leagues in the same record. 

Then, we grouped_by Party and used summarise() to sum the total donations by party for all WNBA owners. This new column was called party_total. To convert that figure to percentages, we used mutate to create a new column called pct_of total. We calculated the values by dividing the amount for each party by the total amount across all parties. 

Last, we wanted to show the pct_of_total not as a decimal but as a percentage (with percent sign) in the dataset. We Googled this and found that a package called scales has a function percent() that does this. We loaded scales at the top of our file, then we used the percent() function to display the percentage as we wanted in the pct_of_total column. Our findings match 538's here too, hooray! 

```{r}

wnba_donations <- donation_df |> 
  filter(str_detect(League, "WNBA")) |> 
  group_by(Party) |> 
  summarise(party_total = sum(Amount)) |>
  mutate(pct_of_total = percent(party_total / sum(party_total)))|> 
  arrange(desc(pct_of_total))
  
wnba_donations

```

##Finding 3

"And of the $1.3 million contributed by WNBA owners to Republicans, 65.5 percent comes from Kelly Loeffler, the Republican from Georgia who is co-owner of the Atlanta Dream." We would like to see what the WNBA figures would look like if we removed the major outlier, Kelly Loeffler. This would give a better sense of overall giving trends in the WNBA, which is the only league that tends to contribute more to Democratic causes. 
--

We know from the code above that WNBA owners contributed $1.3 million to Republican causes. Then we needed to replicate Loeffler's share of that $1.3 million by filtering for her donations to Republican causes. They totaled $876,150. But we needed to see that figure as a percent of the $1.3 million still. So we took the loeffler_r_total variable and divided by row 2 (total Republican donations) from the party_total variable in the wnba_donations dataset above. We replicated 538's finding that Loeffler gave 65.5% of WNBA owners' contributions to Republicans.



```{r}

loeffler_r_wnba_donations <- donation_df |> 
  filter(str_detect(League, "WNBA")) |> 
  filter(Owner == "Kelly Loeffler") |> 
  filter (Party == "Republican") |> 
  summarise (loeffler_r_total = sum(Amount)) |> 
  mutate(percent_of_total = percent(loeffler_r_total / wnba_donations$party_total[2]), accuracy = 0.1)
         
loeffler_r_wnba_donations  
   
```
Although this wasn't present in the article, we also wanted to see what the WNBA's political contributions would look like if we removed Kelly Loeffler, this big outlier. We used a very similar code to Finding #2 (league is WNBA, group by party, sum the amounts), while also filtering out any owners with the name Kelly Loeffler. We found that without her, 72% of WNBA donations went to Democrats. That's over a 20% jump from the 51.7% giving to Democrats that we saw in Finding #2. 

```{r}
wnba_no_loeffler <- donation_df |> 
  filter(str_detect(League, "WNBA")) |> 
  filter(Owner != "Kelly Loeffler") |> 
  group_by(Party) |> 
  summarise (party_total = sum(Amount)) |>
  mutate(pct_of_total = percent(party_total / sum(party_total)))|> 
  arrange(desc(party_total))
   
wnba_no_loeffler 
```


