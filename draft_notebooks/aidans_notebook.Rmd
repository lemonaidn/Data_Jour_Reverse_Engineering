---
title: "CFS_reverse_engineering_project"
output: html_document
date: "2023-10-23"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##Finding 1: 

“A deep search in the Federal Election Commission database of campaign finances for principal owners, controlling owners, co-owners and commissioners from the NBA, NFL, NHL, WNBA, MLB and NASCAR reveals that this deep-pocketed group has sent $34.2 million (72.9 percent) to Republican campaigns or super PACs purely supporting Republican causes, compared to $10.1 million (21.5 percent) to Democrats over the past three elections.”

In order to reproduce this first finding, we had to convert the dollar amount from the amount column from a character to a dbl. We also wanted to figure out how to remove the dollar sign and the comma from each amount entry. So we Googled that and found the parse_number function, which worked well. 

Then, to determine the total amount of donations by political party, we decided to group_by party and use summarise() to create a party_total column that sums the amount donated per party. We then arranged in descending order to get the totals from highest to lowest. We successfully reproduced this first finding from 538's article.

```{r}
library(tidyverse)
library(readr)
library(scales)
library(janitor)

# Load the data from 538

donation_df <- read_csv("sports-political-donations.csv")

# clean column names to change case to lower and remove spaces

donation_df <- clean_names(donation_df)

# Use parse_number to convert the amount column to dbl

donation_df<- donation_df |>
  mutate(amount = parse_number(amount))

# group_by party and use summarise() to create a party_total column that sums the amount donated per party

donations_by_party <- donation_df |>
  group_by(party) |>
  summarise(party_total = sum(amount)) |>
  arrange(desc(party_total))

donations_by_party

```
 

##Finding 2

“Overall, 51.7 percent of all contributions by WNBA owners went to Democrats, with 42.3 percent going to Republicans.”

To reproduce this finding, we initially tried filtering by league = "WNBA," but we were getting incorrect results (Republican was way too high). We realized that this method was missing some rows because certain owners own teams in multiple leagues, and those entries not showing up here. To fix this, we used str_detect to find all correct instances of WNBA in league, even if it was paired with other leagues in the same record. 

Then, we grouped_by party and used summarise() to sum the total donations by party for all WNBA owners. This new column was called party_total. To convert that figure to percentages, we used mutate to create a new column called pct_of total. We calculated the values by dividing the amount for each party by the total amount across all parties. 

Last, we wanted to show the pct_of_total not as a decimal but as a percentage (with percent sign) in the data set. We Googled this and found that a package called scales has a function percent() that does this. We loaded scales at the top of our file, then we used the percent() function to display the percentage as we wanted in the pct_of_total column. Our findings match 538's here too, hooray! 

```{r}

wnba_donations <- donation_df |> 
  filter(str_detect(league, "WNBA")) |> 
  group_by(party) |> 
  summarise(party_total = sum(amount)) |>
  mutate(pct_of_total = percent(party_total / sum(party_total)))|> 
  arrange(desc(pct_of_total))
  
wnba_donations

```


# Finding 3

3) "And of the $1.3 million contributed by WNBA owners to Republicans, 65.5 percent comes from Kelly Loeffler, the Republican from Georgia who is co-owner of the Atlanta Dream." We would like to see what the WNBA figures would look like if we removed the major outlier, Kelly Loeffler. This would give a better sense of overall giving trends in the WNBA, which is the only league that tends to contribute more to Democratic causes.



We refiltered donation_df to only return Kelly Loeffler's donations to Republican causes (and ensured that her records were associated with the WNBA) and summed the total of those donations. We then took the loeffler_r__total variable and divided it by the total Republican donations from WNBA owners that we found while reproducing Finding #2.


```{r}

loeffler_r_wnba_donations <- donation_df |> 
  filter(str_detect(league, "WNBA")) |>
  filter(owner == "Kelly Loeffler") |>
  filter(party == "Republican") |>
  summarise(loeffler_r_total = sum(amount)) |>
  mutate(percent_of_total = percent(loeffler_r_total / wnba_donations$party_total[2], accuracy = 0.1))

loeffler_r_wnba_donations


```

```{r}

wnba_donations$party_total[2]

```
# Finding 4


Although this wasn't present in the article, we also wanted to see what the WNBA's political contributions would look like if we removed Kelly Loeffler, this big outlier. We used a very similar code to Finding #2 (league is WNBA, group by party, sum the amounts), while also filtering out any owners with the name Kelly Loeffler. We found that without her, 72% of WNBA donations went to Democrats. That's over a 20% jump from the 51.7% giving to Democrats that we saw in Finding #2.

```{r}
no_loeffler_wnba <- donation_df |> 
  filter(str_detect(league, "WNBA")) |>
  filter(owner != "Kelly Loeffler") |>
  group_by(party) |> 
  summarise(party_total = sum(amount)) |>
  mutate(pct_of_total = percent(party_total / sum(party_total)))|> 
  arrange(desc(party_total))

no_loeffler_wnba
```

# Finding 5

“Thirteen owners have contributed directly to Trump’s campaign or Trump super PACs in the 2020 election cycle, with contributions adding up to $1,746,423. [...] By contrast, 20 owners have contributed directly to Biden or Biden’s super PACs, though at smaller totals, with overall contributions equaling $405,745.”

Filter by election_year 2020
use a str_detect on Trump and Biden since they each have multiple affiliated PACs with different

```{r}
# update recipient values to all upper case

donation_df <- donation_df %>%
  mutate(recipient = str_to_upper(recipient))

# find the 13 owners who donated to Trump's committee and affiliated committees

donation_df %>%
  filter(election_year == 2020) %>%
  filter(str_detect(recipient, "TRUMP") | str_detect(recipient, "GREAT AMERICA COMMITTEE")) %>%
  group_by(owner) %>%
  summarise(total_amount = sum(amount))


```


```{r}
unique_committees <- donation_df %>%
  filter(election_year == 2020) %>%
  filter(party == "Republican") %>%
  group_by(recipient) %>%
  summarise()

unique_committees
```

```{r}
 # Update recipient values to all upper case
donation_df <- donation_df |> 
  mutate(recipient = str_to_upper(recipient))

trump_2020_contributors <- donation_df %>%
  filter(owner == "Bill Foley" |
           owner == "Bill Hornbuckle (MGM Resorts International)" |
           owner == "Charles Johnson" |
           owner == "Dan DeVos" |
           owner == "Jack Roush" |
           owner == "James L. Dolan" |
           owner == "Kelly Loeffler" |
           owner == "Mike Brown" |
           owner ==  "Peter Karmanos Jr." |
           owner == "Robert Plummer" |
           owner == "Roger Penske" |
           owner == "Tilman J. Fertitta" |
           owner == "Todd Ricketts") %>%
          filter(party == "Republican") %>%
          filter(election_year == 2020) %>%
          group_by(recipient) %>%
          summarise(contributions = sum(amount)) %>%
          arrange(desc(contributions))

trump_2020_contributors

#sum(trump_2020_contributors$contributions)
  
```

```{r}
blah_df <- trump_2020_contributors %>%
  filter(str_detect(recipient, "TRUMP") |
          recipient == "BLACK AMERICANS TO RE-ELECT THE PRESIDENT" |
           recipient == "AMERICA FIRST ACTION, INC.")

sum(blah_df$contributions)

```


##Finding 5

“Thirteen owners have contributed directly to Trump’s campaign or Trump super PACs in the 2020 election cycle, with contributions adding up to $1,746,423. [...] By contrast, 20 owners have contributed directly to Biden or Biden’s super PACs, though at smaller totals, with overall contributions equaling $405,745.”


In our first attempt (per the code below), we were only able to find 12 of the 13 owners mentioned by 538. We filtered for election year 2020, used string detect "Trump" to find committees in the recipient column supporting Trump's reelection. We saved these 12 owners in the dataset "trump_2020" and we know that their contributions total to $1,544,421. That leaves $202,002 missing. 

```{r}
 # Update recipient values to all upper case
donation_df <- donation_df |> 
  mutate(recipient = str_to_upper(recipient))
  
# Find the 13 owners who contributed to Trump's campaign or Trump super PACs. 
 
trump_2020 <- donation_df |> 
  filter(election_year == 2020) |> 
  filter(str_detect(recipient,"TRUMP")) |>
  group_by(owner)

#Huh. We only found 12 owners this way. How much did they contribute together? 

total_12 <- sum(trump_2020$amount)

total_12

#They contributed $1,544,421. How much money are we still looking for? 

1746423 - total_12

#We need to find $202,002 in contributions for Trump still. Let's save the total we're looking for, we may need it as a variable. 

total_13 <- 1746423 

```

We looked back at 538's article to figure out who our missing 13th owner was. The full paragraph was, "Thirteen owners have contributed directly to Trump’s campaign or Trump super PACs in
the 2020 election cycle, with contributions adding up to $1,746,423. That list of owners
includes: Bill Foley (Vegas Golden Knights), Bill Hornbuckle (Las Vegas Aces), Charles
Johnson (San Francisco Giants), Dan Devos (Orlando Magic), Jack Roush
(NASCAR), James Dolan (New York Knicks and Rangers), Kelly Loeffler
(Atlanta Dream), Mike Brown (Cincinnati Bengals), Peter Karmanos (Carolina
Hurricanes), Robert Plummer (Los Angeles Dodgers), Roger Penske (Team
Penske) Tilman Fertitta (Houston Rockets) and Todd Ricketts (Chicago Cubs)" 

So we now know that we are missing Peter Karmanos of the Carolina Hurricanes. Let's look at his 2020 donations to figure out which PACs we are missing. 

```{r}

# Find Peter Karmanos, who according to 538 is our missing 13th owner. 

karmanos_donations <- donation_df |> 
  filter(election_year == 2020) |> 
  filter(str_detect(owner,"Peter Karmanos"))|> 
  group_by(recipient)

total_karmanos <- sum(karmanos_donations$amount)

# Karmanos donated a total of $203702. 

total_karmanos

total_karmanos - total_12

```
Checking the recipients of Karmanos' donations told us that we also needed to include "BLACK AMERICANS TO RE-ELECT THE PRESIDENT" in our list of committees we were filtering by. Only Karmanos and Johnson donated to that recipient though, and both donations were small amounts -- too small to make up the remaining gap.

We wondered if 538 was including certain national, party-based committees recipients in their total for Trump, such as WINRED and the REPUBLICAN NATIONAL COMMITTEE. However, including either or both of those committees still yielded the incorrect total.

```{r}
trump_2020 <- donation_df |> 
  filter(election_year == 2020) |> 
  filter(str_detect(recipient,"TRUMP") |
           recipient == "BLACK AMERICANS TO RE-ELECT THE PRESIDENT" |
            recipient == "REPUBLICAN NATIONAL COMMITTEE" |
            recipient == "WINRED") |>
  group_by(owner) |>
  summarise(contributions = sum(amount))

sum(trump_2020$contributions)
```

Finally, we found this webpage from The Center for Public Integrity that lists a number of Trump-affiliated PACs and a search of the data revealed that America First Action Inc. received in 2020 -- the exact amount to make up the remaining gap between our total and 538's total.

https://publicintegrity.org/politics/donald-trump-army-super-pacs-maga-nonprofits/

```{r}

trump_2020 <- donation_df |> 
  filter(election_year == 2020) |> 
  filter(str_detect(recipient, "TRUMP") |
          recipient == "BLACK AMERICANS TO RE-ELECT THE PRESIDENT" |
           recipient == "AMERICA FIRST ACTION, INC.") |>
  group_by(owner) |>
  summarise(contributions = sum(amount))

sum(trump_2020$contributions)


```