---
title: "ReverseEngineering"
output: html_document
date: "2023-09-27"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Load the data, and use mutate and parse_number to convert the dollar amount from the "amount" column from "character" to "double" while removing the dollar signs and commas.

```{r}
library(tidyverse)
library(readr)
library(scales)
library(janitor)

donation_df<-read_csv("sports-political-donations.csv")

donation_df <- donation_df |> mutate(Amount = parse_number(Amount))

#clean column names to change case to lower and remove spaces

donation_df <- clean_names(donation_df)

donation_df
```

## Finding 1

“A deep search in the Federal Election Commission database of campaign finances for principal owners, controlling owners, co-owners and commissioners from the NBA, NFL, NHL, WNBA, MLB and NASCAR reveals that this deep-pocketed group has sent $34.2 million (72.9 percent) to Republican campaigns or super PACs purely supporting Republican causes, compared to $10.1 million (21.5 percent) to Democrats over the past three elections.”

This sentence presents the main finding of 538’s analysis: overall, major league sports franchise owners contributed overwhelmingly towards Republicans over Democrats. It also provides a glimpse into the methodology and source of the data.

To determine the total amount of donations by political party/affiliation, we decided to group by "Party" and use summarize to create a party_total column and sums the amount donated per party, we then arranged in descending order to get the totals from highest to lowest. We successfully reproduced the first finding from the 538 article.

```{r}
donations_by_party <- donation_df |> 
  group_by(party) |> 
  summarize(party_total = sum(amount)) |> 
  arrange(desc(party_total))

donations_by_party
```

## Finding 2 

“Overall, 51.7 percent of all contributions by WNBA owners went to Democrats, with 42.3 percent going to Republicans.” 

To reproduce this finding, we initially tried filtering by League=="WNBA", but were getting incorrect results. We realized this method was causing us to miss rows, because some owners owned teams in multiple leagues, all of which were listed together. Instead, we used str_detect to find all correct instances of WNBA in League even if it was paired with other leagues in the same record.

Then we grouped by party and created a party_amount column using summarize to sum the total donations for all WNBA owners to convert that to percentages. We used mutate to create a new column "pct_of_total" and calculated the values by dividing the amount for each party by the total amount across all parties. We also used a "percent" function from the scales package that we loaded at the top of our file to add the percent sign so that it doesn't just show as a decimal, which we found on Google. Our findings match 538's.

```{r}
WNBA_donations <- donation_df |> 
  filter(str_detect(league, 'WNBA')) |> 
  group_by(party) |> 
  summarize(party_total = sum(amount)) |> 
  arrange(desc(party_total))

WNBA_donations <- WNBA_donations |> 
  mutate(pct_of_total = percent(party_total/sum(party_total)), accuracy = 0.1)

WNBA_donations
```

## Finding 3

"And of the $1.3 million contributed by WNBA owners to Republicans, 65.5 percent comes from Kelly Loeffler, the Republican from Georgia who is co-owner of the Atlanta Dream." 

We would like to see what the WNBA figures would look like if we removed the major outlier, Kelly Loeffler. This would give a better sense of overall giving trends in the WNBA, which is the only league that tends to contribute more to Democratic causes.

We know from the code above that WNBA owners contributed $1.3 million to Republican causes. Then we needed to replicate Loeffler's share of that $1.3 million by filtering for her donations to Republican causes. They totaled $876,150. But we needed to see that figure as a percent of the $1.3 million still. So we took the loeffler_r_total variable and divided by row 2 (total Republican donations) from the party_total variable in the wnba_donations dataset above. We replicated 538's finding that Loeffler gave 65.5% of WNBA owners' contributions to Republicans.

```{r}
loeffler_r_wnba_donations <- donation_df |> 
  filter(str_detect(league, 'WNBA')) |> 
  filter(owner == "Kelly Loeffler") |> 
  filter(party=="Republican") |> 
  summarize(loeffler_r_total=sum(amount)) |> 
  mutate(percent_of_total = percent(loeffler_r_total / WNBA_donations$party_total[2], accuracy = 0.1))

loeffler_r_wnba_donations

```

Although this wasn't present in the article, we also wanted to see what the WNBA's political contributions would look like if we removed Kelly Loeffler, this big outlier. We used a very similar code to Finding #2 (league is WNBA, group by party, sum the amounts), while also filtering out any owners with the name Kelly Loeffler. We found that without her, 72% of WNBA donations went to Democrats. That's over a 20% jump from the 51.7% giving to Democrats that we saw in Finding #2.

```{r}
wnba_no_loeffler <- donation_df |> 
  filter(str_detect(league, 'WNBA')) |> 
  filter(owner != "Kelly Loeffler") |> 
  group_by(party) |> 
  summarize(party_total = sum(amount)) |> 
  mutate(pct_of_total = percent(party_total/sum(party_total))) |> 
  arrange(desc(party_total))

wnba_no_loeffler
```


## Finding 4

Although this wasn't present in the article, we also wanted to see what the WNBA's political contributions would look like if we removed Kelly Loeffler, this big outlier. We used a very similar code to Finding #2 (league is WNBA, group by party, sum the amounts), while also filtering out any owners with the name Kelly Loeffler. We found that without her, 72% of WNBA donations went to Democrats. That's over a 20% jump from the 51.7% giving to Democrats that we saw in Finding #2. 

```{r}
wnba_no_loeffler <- donation_df |> 
  filter(str_detect(league, "WNBA")) |> 
  filter(owner != "Kelly Loeffler") |> 
  group_by(party) |> 
  summarise (party_total = sum(amount)) |>
  mutate(pct_of_total = percent(party_total / sum(party_total)))|> 
  arrange(desc(party_total))
   
wnba_no_loeffler 
```

##Finding 5

“Thirteen owners have contributed directly to Trump’s campaign or Trump super PACs in the 2020 election cycle, with contributions adding up to $1,746,423. [...] By contrast, 20 owners have contributed directly to Biden or Biden’s super PACs, though at smaller totals, with overall contributions equaling $405,745.”


In our first attempt (per the code below), we were only able to find 12 of the 13 owners mentioned by 538. We filtered for election year 2020, used string detect "Trump" to find committees in the recipient column supporting Trump's reelection. We saved these 12 owners in the dataset "trump_2020" and we know that their contributions total to $1,544,421. That leaves $202,002 missing. 

```{r}
 # Update recipient values to all upper case
donation_df <- donation_df |> 
  mutate(recipient = str_to_upper(recipient))
  
# Find the 13 owners who contributed to Trump's campaign or Trump super PACs. 
 
trump_2020 <- donation_df |> 
  filter(election_year == 2020) |> 
  filter(str_detect(recipient,"TRUMP")) |>
  group_by(owner)

#Huh. We only found 12 owners this way. How much did they contribute together? 

total_12 <- sum(trump_2020$amount)

total_12

#They contributed $1,544,421. How much money are we still looking for? 

1746423 - total_12

#We need to find $202,002 in contributions for Trump still. Let's save the total we're looking for, we may need it as a variable. 

total_13 <- 1746423 

```

We looked back at 538's article to figure out who our missing 13th owner was. The full paragraph was, "Thirteen owners have contributed directly to Trump’s campaign or Trump super PACs in
the 2020 election cycle, with contributions adding up to $1,746,423. That list of owners
includes: Bill Foley (Vegas Golden Knights), Bill Hornbuckle (Las Vegas Aces), Charles
Johnson (San Francisco Giants), Dan Devos (Orlando Magic), Jack Roush
(NASCAR), James Dolan (New York Knicks and Rangers), Kelly Loeffler
(Atlanta Dream), Mike Brown (Cincinnati Bengals), Peter Karmanos (Carolina
Hurricanes), Robert Plummer (Los Angeles Dodgers), Roger Penske (Team
Penske) Tilman Fertitta (Houston Rockets) and Todd Ricketts (Chicago Cubs)" 

So we now know that we are missing Peter Karmanos of the Carolina Hurricanes. Let's look at his 2020 donation to figure out which PACs we are missing. 

```{r}

# Find Peter Karmanos, who according to 538 is our missing 13th owner. 

karmanos_donations <- donation_df |> 
  filter(election_year == 2020) |> 
  filter(str_detect(owner,"Peter Karmanos"))|> 
  group_by(recipient)

total_karmanos <- sum(karmanos_donations$amount)

# Karmanos donated a total of $203702. 

total_karmanos

total_karmanos - total_12

# It looks like a lot of these contributions are for state-wide races, not the presidency. 

karmanos_donations_president <- karmanos_donations |> 
  filter(
   recipient == "BLACK AMERICANS TO RE-ELECT THE PRESIDENT" | 
    recipient == "REPUBLICAN NATIONAL COMMITTEE" | 
    recipient == "HUCK PAC" | 
    recipient == "STARS AND STRIPES FOREVER PAC" |
    recipient == "AMERICA FIRST ACTION INC")
karmanos_president_total <- sum(karmanos_donations_president$amount)

karmanos_president_total

#Okay, it looks like Karmanos donated $134,602 to presidential campaigns. 

total_13 - total_12 - karmanos_president_total

#We are still missing $67,400 in donations towards Trump. Which means I guess we are missing something from one of the 12 guys we found above. I AM CONFUSED AND I"M SORRY I COULN"T FIGURE IT OUT YOU GUYS. 
  
```


```{r}
# Find the 20 owners who contributed to Biden's campaign or Biden super PACs. 
 donation_df |> 
  filter(election_year == 2020) |> 
  filter(str_detect(recipient,"BIDEN")) |>
  group_by(owner) |>
  summarise (count = n())

democratic_PACS_2020 <-donation_df |>
  group_by(recipient)|>
  filter(party !=  "Republican")|>
  filter(election_year == 2020) |>
  arrange (recipient)
democratic_PACS_2020

# Find the 20 owners who contributed to Biden's campaign or Biden super PACs.
biden_2020 <- donation_df |>
  group_by(owner) |>
  filter(team != "Commissioner") |> 
  filter(election_year == 2020) |>
  filter(str_detect(recipient,"BIDEN")) | (str_detect(recipient,"UNITE THE COUNTRY")) |>
  summarise (total = sum(amount))
biden_2020

```
